<!doctype html>
<html lang="en">

<head>
  	{% load static %}
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="{% static 'homepage/assets/img/apple-icon.png' %}">
  <link rel="icon" type="image/png" href="{% static 'homepage/assets/img/favicon.png' %}">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Your Health
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="{% static 'homepage/assets/css/material-dashboard.css' %}" rel="stylesheet" />
  {% load static %} 

  <style>
    .card-medicine{
      width: 70%; position: relative; left: 50%; transform: translateX(-50%);
    }
  </style>
</head>

<body class="">
  <div class="wrapper ">
      <div class="sidebar" data-color="green" data-background-color="white" data-image="../assets/img/sidebar-1.jpg">
        <!--
          Tip 1: You can change the color of the sidebar using: data-color="purple | azure | green | orange | danger"
  
          Tip 2: you can also add an image using data-image tag
      -->
        <div class="logo">
          <a href="" class="simple-text logo-normal">
            Re:Med
          </a>
        </div>
        <div class="sidebar-wrapper">
          <ul class="nav">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'dashboard' %}">
                <i class="material-icons">dashboard</i>
                <p>Dashboard</p>
              </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="{% url 'user' %}">
                <i class="material-icons">person</i>
                <p>User Profile</p>
              </a>
            </li>

            <li class="nav-item active">
                <a class="nav-link" href="{% url 'diseases' %}">
                  <i class="material-icons">list_alt</i>
                  <p>Diseases</p>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="{% url 'stats' %}">
                  <i class="material-icons">list_alt</i>
                  <p>Statistics</p>
                </a>
            </li>
            <!-- <li class="nav-item ">
              <a class="nav-link" href="./tables.html">
                <i class="material-icons">content_paste</i>
                <p>Table List</p>
              </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="./typography.html">
                <i class="material-icons">library_books</i>
                <p>Typography</p>
              </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="./icons.html">
                <i class="material-icons">bubble_chart</i>
                <p>Icons</p>
              </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="./map.html">
                <i class="material-icons">location_ons</i>
                <p>Maps</p>
              </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="./notifications.html">
                <i class="material-icons">notifications</i>
                <p>Notifications</p>
              </a>
            </li> -->
            <!-- <li class="nav-item active-pro ">
                  <a class="nav-link" href="./upgrade.html">
                      <i class="material-icons">unarchive</i>
                      <p>Upgrade to PRO</p>
                  </a>
              </li> -->
          </ul>
        </div>
      </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="#pablo">Dashboard</a>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end">
            <ul class="navbar-nav">
              <li class="nav-item">
                
              </li>
              <!-- your navbar here -->
            </ul>
          </div>
        </div>
      </nav>
      <!-- End Navbar -->
      <div class="content">
        <div class="container-fluid new-diseases">
          <!-- your content here -->
          <!-- <div class="row">
              <div class="card card-nav-tabs text-center card-medicine">
                  <div class="card-header card-header-primary">
                    Dengue
                  </div>
                  <div class="card-body">
                    <h4 class="card-title">Prognosis</h4>
                    <p class="card-text">Lorem ipsum afbfakn  flashlka lklfs </p>
                    <a href="#" class="btn btn-primary">Details</a>
                  </div>
                  <div class="card-footer text-muted">
                    19/10/2018 - Present
                  </div>
              </div>
          </div>

          <div class="row">
              <div class="card card-nav-tabs text-center card-medicine">
                  <div class="card-header card-header-primary">
                    Dengue
                  </div>
                  <div class="card-body">
                    <h4 class="card-title" id="diseaseName">Prognosis</h4>
                    <p class="card-text" id="diseaseDescription">Lorem ipsum afbfakn  flashlka lklfs </p>
                    <a href="#" class="btn btn-primary">Prescrition</a>
                  </div>
                  <div class="card-footer text-muted">
                    19/10/2017 - 19/10/2018
                  </div>
              </div>
          </div> -->

          
          <!-- Modal -->
          <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Add Prognosis</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                      <div class="row">
                          <div class="col-md-12">
                            <div class="form-group">
                              <label class="bmd-label-floating">Disease Name</label>
                              <input type="email" class="form-control" id="diseaseName">
                            </div>
                          </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                  <label class="bmd-label-floating">Start Date</label>
                                  <input type="text" class="form-control" id="startTime">
                                </div>
                            </div>

                            <!-- <div class="col-md-6">
                                <div class="form-group">
                                  <label class="bmd-label-floating" id="endTime">End Date</label>
                                  <input type="text" class="form-control">
                                </div>
                            </div> -->

                            <!-- <div class="col-md-6">
                                <div class="form-group">
                                  <label class="form-check-input" type="checkbox" >End Date</label>
                                  <input type="text" class="form-control">
                                </div>
                            </div> -->
                        </div>

                        <br>
                        <button type="submit" class="btn btn-primary pull-right" id="addPrognosis" data-dismiss="modal">Add a condition</button>
                        <button type="button" class="btn btn-secondary pull-right" data-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
                  </div>
        </div>
        <a href="#" data-toggle="modal" data-target="#exampleModal"><i class="material-icons" style="color: rgb(253, 147, 8); font-size: 64px; position: relative; left: 92%">add_circle</i></a>

      </div>
      <footer class="footer">
          <div class="container-fluid">
            <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script>, made with <i class="material-icons">favorite</i> by
            <a href="https://github.com/falconis/Re-Med" target="_blank"> Codeplay</a> for a<a href="https://prototypeiiita.github.io/" target="_blank"> Prototype</a>.
            </div>
          </div>
          </footer>
    </div>
  </div>

  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.26.9/dist/sweetalert2.all.min.js"></script>
  
  <script>

    var token = localStorage.getItem("token");
      console.log(token);
      if(token == null){
        token = '';
      }    
      $.ajax({
        url : "/prognosis_list/",
        type : 'get',
        beforeSend : function(request){
          request.setRequestHeader("Authorization",
            "Token " + token);
        },
        dataType : 'json',
        success: function(data){
          console.log(data);
          for(var i = 0; i < data.length; i++){
            var div1 = document.createElement("div");
            div1.classList.add("row");

            var div2 = document.createElement("div");
            div2.classList.add("card");
            div2.classList.add("card-nav-tabs");
            div2.classList.add("text-center");
            div2.classList.add("card-medicine");

            var div2_1 = document.createElement("div");
            div2_1.classList.add("card-header");
            div2_1.classList.add("card-header-success");
            div2_1.innerText = data[i]["diseaseName"];

            var div2_2 = document.createElement("div");
            div2_2.classList.add("card-body");
            div2_2.innerText = data[i]["diseaseDescription"];
            
            
            
            var prescrition = data[i]["prescription"]
            for(var j = 0; j < prescrition.length; j++){
              var a2_3 = document.createElement("h4");
              var p = document.createElement("p");
              p.classList.add('card-text');
              var sched = 'Schedule :\n';
              if(prescrition[j]['morning']>0.0) {
                sched += 'Morning\n';
              }
              if(prescrition[j]['afternoon']>0.0) {
                sched += 'Afternoon\n';
              }
              if(prescrition[j]['evening']>0.0) {
                sched += 'Evening\n';
              }
              if(prescrition[j]['night']>0.0) {
                sched += 'Night\n';
              }
              p.innerText = sched;
              a2_3.classList.add("card-title");
              a2_3.innerText = "\n" + prescrition[j]["medicineName"];
              div2_2.appendChild(a2_3);
              div2_2.appendChild(p);
            }
            div2.appendChild(div2_1);
            div2.appendChild(div2_2);
            
            var div3 = document.createElement("div");
            div3.classList.add("class-footer");
            div3.classList.add("text-muted");
            div3.innerText = "\n" + data[i]['startTime'];
            var end = data[i]['endTime'];
            if(end==null){
              div3.innerText += " - Ongoing\n";
            }
            else {
              div3.innerText += end + '   \n';
            }
            div3.innerText += '\n';
            
            div2.appendChild(div3);
            div1.appendChild(div2);
            var newDiseases = document.querySelector(".new-diseases");
            newDiseases.appendChild(div1);
          }
        },
        error: function(MLHttpRequest, textStatus, errorThrown){
          if(phone.length != 10){
            alert("Enter valid phone number");
          }
          else{
            for(key in MLHttpRequest.responseJSON){
              if(String(MLHttpRequest.responseJSON[key]) == "This value does not match the required pattern."){
                swal("Please enter correct FB link");
              }
              else{
                swal(String(MLHttpRequest.responseJSON[key]));
              }
            }
          }
          window.location.href = "/auth_forms/prognosis_list/";
        }
      });
      
      $("#addPrognosis").on("click", function(e) {
        
        var diseaseName = $('#diseaseName').val();
        var startTime = $('#startTime').val();
        $.ajax({
          url : "/prognosis_disease_add/",
          type : 'post',
          beforeSend : function(request){
            request.setRequestHeader("Authorization",
              "Token " + token);
              console.log(startTime);
          },
          data : {
            'diseaseName': diseaseName, 
            'startTime': startTime,
          },
          dataType : 'json',
          success: function(data){
            console.log("Then Done");
            window.location.href = "/auth_forms/diseases/";
          },
          error: function(MLHttpRequest, textStatus, errorThrown){
            console.log(diseaseName);
            //window.location.href = "/auth_forms/diseases/";
          }
        });
      });
  
  </script>

  <!--   Core JS Files   -->
  <script src="{% static 'homepage/assets/js/core/jquery.min.js' %}" type="text/javascript"></script>
  <script src="{% static 'homepage/assets/js/core/popper.min.js' %}" type="text/javascript"></script>
  <script src="{% static 'homepage/assets/js/core/bootstrap-material-design.min.js' %}" type="text/javascript"></script>
  <script src="{% static 'homepage/assets/js/plugins/perfect-scrollbar.jquery.min.js' %}"></script>
  <!--  Google Maps Plugin    -->
  <script src="{% static 'https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE' %}"></script>
  <!-- Chartist JS -->
  <script src="{% static 'homepage/assets/js/plugins/chartist.min.js' %}"></script>
  <!--  Notifications Plugin    -->
  <script src="{% static 'homepage/assets/bootstrap-notify.js' %}"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="{% static 'homepage/assets/js/material-dashboard.min.js?v=2.1.0' %}" type="text/javascript"></script>
</body>

</html>